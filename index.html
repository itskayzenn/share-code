<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DevCode Share - Hub</title>

<link rel="icon" href="profile.jpg">
<script src="https://cdn.tailwindcss.com"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap');

body {
    font-family: 'Plus Jakarta Sans', sans-serif;
    background: linear-gradient(rgba(0,0,0,.85), rgba(0,0,0,.85)), url('image.jpg');
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    min-height: 100vh;
    color: #f3f4f6;
}

/* ===== GLASS FIX CHROME ===== */
.glass {
    background: rgba(255,255,255,.04);
    backdrop-filter: blur(14px);
    -webkit-backdrop-filter: blur(14px);
    border: 1px solid rgba(255,255,255,.08);
    will-change: backdrop-filter;
}

.glass-dark {
    background: rgba(0,0,0,.65);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255,255,255,.1);
}

/* ===== PRE / CODE FIX ===== */
pre, code {
    transform: translateZ(0);
    backface-visibility: hidden;
    -webkit-font-smoothing: antialiased;
}

pre {
    background: rgba(0,0,0,.45);
    padding: 1.25rem;
    border-radius: 1rem;
    overflow-x: auto;
}

/* scrollbar */
::-webkit-scrollbar { width: 6px }
::-webkit-scrollbar-thumb {
    background: rgba(59,130,246,.4);
    border-radius: 10px;
}
</style>
</head>

<body class="flex flex-col">

<nav class="glass p-4 sticky top-0 z-50">
    <div class="max-w-6xl mx-auto flex justify-between items-center">
        <h1 class="font-black tracking-tight">DEV_SHARE</h1>
        <button onclick="toggleDev()" id="loginBtn"
            class="bg-white/5 border border-white/10 px-6 py-2 rounded-full text-xs font-bold">
            Access Admin
        </button>
    </div>
</nav>

<main class="flex-grow max-w-5xl mx-auto p-6">

<section id="devSection" class="hidden glass-dark p-8 rounded-3xl mb-12">
    <h2 id="formTitle" class="text-blue-400 font-bold mb-4">Share New Snippet</h2>

    <input type="hidden" id="editId">

    <input id="codeTitle" placeholder="Filename..."
        class="w-full p-4 mb-4 bg-black/30 rounded-xl border border-white/10">

    <textarea id="codeContent" rows="8" placeholder="Paste code here..."
        class="w-full p-4 bg-black/30 rounded-xl border border-white/10 font-mono"></textarea>

    <div class="flex gap-4 mt-4">
        <button onclick="saveCode()" id="saveBtn"
            class="flex-1 bg-blue-600 rounded-xl p-4 font-bold">
            Publish
        </button>
        <button onclick="resetForm()" id="cancelEditBtn"
            class="hidden bg-white/10 rounded-xl px-8 font-bold">
            Cancel
        </button>
    </div>
</section>

<section>
    <input id="searchInput" onkeyup="renderCodes()"
        placeholder="Search snippet..."
        class="w-full p-4 mb-8 rounded-full bg-white/5 border border-white/10">

    <div id="codeDisplayArea" class="grid gap-8"></div>
</section>

</main>

<footer class="glass-dark p-8 text-center text-xs opacity-40">
    Â© 2026 Kayzen Fry
</footer>

<script>
let isDev = false;
const DEV_KEY = "kayzenganteng";

function escapeHTML(str){
    return str.replace(/[&<>"']/g,m=>({
        '&':'&amp;','<':'&lt;','>':'&gt;',
        '"':'&quot;',"'":'&#39;'
    }[m]));
}

function toggleDev(){
    if(!isDev){
        const pass = prompt("Admin password:");
        if(pass === DEV_KEY){
            isDev = true;
            document.getElementById('devSection').classList.remove('hidden');
            document.getElementById('loginBtn').innerText = "Logout Admin";
        }
    } else {
        isDev = false;
        document.getElementById('devSection').classList.add('hidden');
        document.getElementById('loginBtn').innerText = "Access Admin";
        resetForm();
    }
    renderCodes();
}

function saveCode(){
    const title = codeTitle.value;
    const content = codeContent.value;
    if(!title || !content) return alert("Isi semua");

    let data = JSON.parse(localStorage.getItem('sharedCodes')) || [];

    if(editId.value){
        data = data.map(x =>
            x.id == editId.value ? {...x,title,content} : x
        );
    } else {
        data.unshift({
            id: Date.now(),
            title,
            content,
            date: new Date().toLocaleDateString("id-ID")
        });
    }

    localStorage.setItem('sharedCodes', JSON.stringify(data));
    resetForm();
    renderCodes();
}

function resetForm(){
    editId.value = "";
    codeTitle.value = "";
    codeContent.value = "";
    saveBtn.innerText = "Publish";
    cancelEditBtn.classList.add('hidden');
}

function startEdit(id){
    const data = JSON.parse(localStorage.getItem('sharedCodes')) || [];
    const item = data.find(x=>x.id===id);
    if(!item) return;

    editId.value = item.id;
    codeTitle.value = item.title;
    codeContent.value = item.content;
    saveBtn.innerText = "Update";
    cancelEditBtn.classList.remove('hidden');
}

function deleteCode(id){
    if(!confirm("Hapus snippet?")) return;
    let data = JSON.parse(localStorage.getItem('sharedCodes')) || [];
    localStorage.setItem('sharedCodes',
        JSON.stringify(data.filter(x=>x.id!==id))
    );
    renderCodes();
}

function viewRaw(id){
    window.open(`raw.html?id=${id}`, "_blank");
}

function renderCodes(){
    const area = document.getElementById('codeDisplayArea');
    const q = searchInput.value.toLowerCase();
    const data = (JSON.parse(localStorage.getItem('sharedCodes'))||[])
        .filter(x=>x.title.toLowerCase().includes(q));

    area.innerHTML = data.length ? "" : "<div class='opacity-40'>No snippet</div>";

    data.forEach(item=>{
        area.innerHTML += `
        <div class="glass p-6 rounded-3xl">
            <div class="flex justify-between mb-4">
                <div>
                    <h3 class="font-bold">${item.title}</h3>
                    <small class="opacity-40">${item.date}</small>
                </div>
                <div class="flex gap-2">
                    <button onclick="viewRaw(${item.id})"
                        class="bg-blue-600/20 px-4 py-2 rounded-xl text-xs">RAW</button>
                    ${isDev?`
                    <button onclick="startEdit(${item.id})"
                        class="bg-blue-600/20 px-4 py-2 rounded-xl text-xs">EDIT</button>
                    <button onclick="deleteCode(${item.id})"
                        class="bg-red-600/20 px-4 py-2 rounded-xl text-xs">DEL</button>`:""}
                </div>
            </div>
            <pre><code>${escapeHTML(item.content)}</code></pre>
        </div>`;
    });
}

renderCodes();
</script>
</body>
</html>
