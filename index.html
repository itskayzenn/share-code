<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kayzen Izumi | Snippets</title>
    <link rel="icon" href="https://i.ibb.co.com/wrrLvKCP/image.jpg" type="image/x-icon">
    
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://shcdn.vercel.app/">
    <meta property="og:title" content="Kayzen Izumi | Code Snippets & Portofolio">
    <meta property="og:description" content="Platform berbagi snippets dengan mudah dan cepat oleh Kayzen Izumi.">
    <meta property="og:image" content="https://i.ibb.co.com/wrrLvKCP/image.jpg">

    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://shcdn.vercel.app/">
    <meta property="twitter:title" content="Kayzen Izumi | Portfolio">
    <meta property="twitter:description" content="Platform berbagi snippets dengan mudah dan cepat oleh Kayzen Izumi.">
    <meta property="twitter:image" content="https://i.ibb.co.com/wrrLvKCP/image.jpg">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #0f172a; color: #f8fafc; }
        .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.05); }
        .profile-img { width: 120px; height: 120px; border-radius: 50%; border: 3px solid #38bdf8; object-fit: cover; box-shadow: 0 0 20px rgba(56, 189, 248, 0.3); }
        .hidden-section { display: none; }
        .active-nav { color: #38bdf8; border-bottom: 2px solid #38bdf8; }
        pre::-webkit-scrollbar { height: 4px; }
        pre::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
    </style>
</head>
<body class="min-h-screen">

    <nav class="fixed top-0 w-full z-50 glass px-6 py-4 flex justify-between items-center border-b border-white/5">
        <h1 class="text-lg font-bold text-sky-400">Kayzen.dev</h1>
        <div class="flex gap-4 md:gap-6 text-xs font-medium text-slate-400">
            <button onclick="showSection('home')" class="nav-link hover:text-white transition">Home</button>
            <button onclick="showSection('snippets')" class="nav-link hover:text-white transition">Snippets</button>
            <button onclick="showSection('request')" class="nav-link hover:text-white transition">Request</button>
            <button onclick="showSection('contact')" class="nav-link hover:text-white transition">Contact</button>
            <button onclick="showSection('admin')" class="nav-link text-sky-500 font-bold">Admin</button>
        </div>
    </nav>

    <main class="container mx-auto pt-28 px-6 pb-12">
        
        <section id="home" class="section-content animate-fade-in text-center">
            <img src="https://i.ibb.co.com/wrrLvKCP/image.jpg" alt="Kayzen Izumi" class="profile-img mx-auto mb-6">
            <h2 class="text-3xl font-bold mb-1">Kayzen Izumi</h2>
            <p class="text-sky-400 text-sm mb-8">Fullstack Developer & Bot Specialist</p>
            
            <div class="max-w-xl mx-auto glass p-6 rounded-2xl mb-8">
                <h3 class="text-sm font-bold text-slate-300 mb-2">About Me</h3>
                <p class="text-slate-400 text-xs leading-relaxed">
                    Halo! Saya Kayzen, seorang pengembang yang berfokus pada otomasi bot dan scraping data. 
                    Saya senang membangun solusi efisien untuk kebutuhan digital Anda.
                </p>
            </div>

            <div class="grid grid-cols-2 gap-4 max-w-xl mx-auto text-left">
                <div class="glass p-5 rounded-xl">
                    <h4 class="text-xs font-bold mb-3 flex items-center gap-2"><i data-lucide="code-2" class="w-3 h-3 text-sky-400"></i> Skills</h4>
                    <div class="flex flex-wrap gap-1">
                        <span class="bg-slate-800 text-[10px] px-2 py-0.5 rounded">Node.js</span>
                        <span class="bg-slate-800 text-[10px] px-2 py-0.5 rounded">Python</span>
                        <span class="bg-slate-800 text-[10px] px-2 py-0.5 rounded">Supabase</span>
                    </div>
                </div>
                <div class="glass p-5 rounded-xl">
                    <h4 class="text-xs font-bold mb-1 flex items-center gap-2"><i data-lucide="award" class="w-3 h-3 text-sky-400"></i> Project Selesai</h4>
                    <p class="text-2xl font-bold">50+</p>
                    <p class="text-slate-500 text-[10px]">Automated Bots & Tools</p>
                </div>
            </div>
        </section>

        <section id="snippets" class="section-content hidden-section">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-bold">Snippets</h2>
                <input type="text" id="search" onkeyup="search()" placeholder="Cari kode..." class="bg-slate-900 border border-slate-800 rounded-lg px-3 py-1.5 text-xs outline-none focus:border-sky-500 w-40 md:w-60">
            </div>
            <div id="snippetsList" class="grid md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
        </section>

        <section id="request" class="section-content hidden-section max-w-lg mx-auto">
            <div class="glass p-6 rounded-2xl">
                <h2 class="text-lg font-bold mb-4">Request Scrape & Feature</h2>
                <form id="reqForm" class="space-y-3">
                    <input type="text" id="rNama" placeholder="Nama (Wajib)" required class="w-full bg-slate-900 border border-slate-800 rounded-lg p-2.5 text-xs outline-none focus:border-sky-500">
                    <input type="url" id="rUrl" placeholder="URL: https://contoh.com (Wajib)" required class="w-full bg-slate-900 border border-slate-800 rounded-lg p-2.5 text-xs outline-none focus:border-sky-500">
                    <textarea id="rDesc" placeholder="Deskripsi: scrape [topic] ini, hanya bagian [yang diminta] (Wajib)" required class="w-full bg-slate-900 border border-slate-800 rounded-lg p-2.5 text-xs h-24 outline-none focus:border-sky-500"></textarea>
                    <button type="submit" class="w-full bg-sky-600 hover:bg-sky-500 py-2.5 rounded-lg text-xs font-bold transition">Kirim Request</button>
                </form>
            </div>
        </section>

        <section id="contact" class="section-content hidden-section max-w-2xl mx-auto">
            <h2 class="text-xl font-bold mb-6 text-center">Let's Connect</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                <a href="https://wa.me/628152313006" class="glass p-4 rounded-xl flex flex-col items-center hover:bg-sky-500/5 transition">
                    <i data-lucide="message-circle" class="w-5 h-5 text-green-400 mb-1"></i><span class="text-[10px]">WhatsApp</span>
                </a>
                <a href="https://t.me/nonewpo" class="glass p-4 rounded-xl flex flex-col items-center hover:bg-sky-500/5 transition">
                    <i data-lucide="send" class="w-5 h-5 text-sky-400 mb-1"></i><span class="text-[10px]">Telegram</span>
                </a>
                <a href="https://github.com/Kayzen-dev-tech" class="glass p-4 rounded-xl flex flex-col items-center hover:bg-sky-500/5 transition">
                    <i data-lucide="github" class="w-5 h-5 text-white mb-1"></i><span class="text-[10px]">GitHub</span>
                </a>
                <a href="mailto:kayzz.my@gmail.com" class="glass p-4 rounded-xl flex flex-col items-center hover:bg-sky-500/5 transition">
                    <i data-lucide="mail" class="w-5 h-5 text-red-400 mb-1"></i><span class="text-[10px]">Email</span>
                </a>
            </div>
        </section>

        <section id="admin" class="section-content hidden-section max-w-lg mx-auto">
            <div id="loginPanel" class="glass p-6 rounded-2xl">
                <h2 class="text-lg font-bold mb-4">Owner Login</h2>
                <input type="password" id="admPass" placeholder="Masukkan Password Admin" class="w-full bg-slate-900 border border-slate-800 rounded-lg p-2.5 text-xs outline-none mb-4">
                <button onclick="login()" class="w-full bg-white text-black font-bold py-2.5 rounded-lg text-xs">Login</button>
            </div>
            <div id="adminDashboard" class="hidden-section space-y-4">
                <div id="dropZone" class="border-2 border-dashed border-slate-800 rounded-xl p-8 text-center hover:border-sky-500 cursor-pointer transition">
                    <i data-lucide="upload" class="mx-auto w-8 h-8 text-slate-500 mb-2"></i>
                    <p class="text-xs text-slate-400">Drop hingga 10 file di sini atau klik</p>
                    <input type="file" id="fileIn" multiple class="hidden">
                </div>
                <div id="upPreview" class="space-y-1"></div>
                <button id="btnUp" onclick="upload()" class="hidden w-full bg-sky-600 py-2.5 rounded-lg text-xs font-bold">Publish Snippets</button>
            </div>
        </section>
    </main>

    <div id="rawModal" class="fixed inset-0 z-[100] bg-black/95 hidden p-6 overflow-auto">
        <div class="flex justify-between items-center mb-4">
            <span id="rawPath" class="text-sky-400 text-xs font-mono"></span>
            <button onclick="closeRaw()" class="text-slate-500"><i data-lucide="x"></i></button>
        </div>
        <pre id="rawText" class="text-xs text-slate-300 font-mono whitespace-pre-wrap"></pre>
    </div>

    <script>
        // --- ENV CONFIG ---
        // PENTING: Saat di Vercel, variabel ini akan diambil dari sistem env.
        // Untuk testing lokal, kamu bisa isi manual atau gunakan nilai di .env.
        const CONFIG = {
            SB_URL: 'https://xcugdkmkloosooyzwyte.supabase.co',
            SB_KEY: 'sb_publishable_tFSi6uQth6ZMyUIduLjkpA_5r0JbE2m',
            ADMIN_PASS: 'kayzenganteng', // Sesuaikan dengan .env
            TG_ADMIN: '8415064497:AAGprLIhNq45Kr6m-QNu5ZFcpcWvvlRWYuk',
            TG_REQ: '8455571859:AAFzJU3hS0iv7mVVh6sZEj0LlzU0237Kuqk',
            CHAT_ID: '6442476342'
        };

        const { createClient } = window.supabase;
        const _db = createClient(CONFIG.SB_URL, CONFIG.SB_KEY);
        let isAdmin = false;
        let filesToUpload = [];

        function showSection(id) {
            document.querySelectorAll('.section-content').forEach(s => s.classList.add('hidden-section'));
            document.getElementById(id).classList.remove('hidden-section');
            if(id === 'snippets') loadSnippets();
            lucide.createIcons();
        }

        async function loadSnippets() {
            const list = document.getElementById('snippetsList');
            list.innerHTML = '<p class="text-xs text-slate-500 italic">Memuat kode...</p>';
            const { data, error } = await _db.from('snippets').select('*').order('created_at', {ascending: false});
            
            if(error) return list.innerHTML = 'Error loading data.';
            
            list.innerHTML = data.map(i => `
                <div class="glass p-4 rounded-xl border-t-2 border-sky-500/30">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="text-sm font-bold truncate w-32">${i.title}</h3>
                        <div class="flex gap-2">
                            <button onclick="copy('${i.id}')" class="hover:text-sky-400"><i data-lucide="copy" class="w-3.5 h-3.5"></i></button>
                            <button onclick="viewRaw('${i.id}')" class="hover:text-sky-400"><i data-lucide="external-link" class="w-3.5 h-3.5"></i></button>
                            ${isAdmin ? `<button onclick="del('${i.id}')" class="text-red-500"><i data-lucide="trash-2" class="w-3.5 h-3.5"></i></button>` : ''}
                        </div>
                    </div>
                    <p class="text-[10px] text-slate-500 mb-3 line-clamp-2">${i.description || 'No desc'}</p>
                    <pre class="bg-black/30 p-3 rounded-lg text-[9px] text-sky-300 overflow-x-auto h-20 border border-white/5"><code>${escape(i.code)}</code></pre>
                    <input type="hidden" id="c-${i.id}" value="${escape(i.code)}">
                    <input type="hidden" id="t-${i.id}" value="${i.title}">
                </div>
            `).join('');
            lucide.createIcons();
        }

        // --- REQUEST ---
        document.getElementById('reqForm').onsubmit = async (e) => {
            e.preventDefault();
            const msg = `ðŸ“¬ *REQUEST BARU*\n\n*Nama:* ${document.getElementById('rNama').value}\n*URL:* ${document.getElementById('rUrl').value}\n*Desc:* ${document.getElementById('rDesc').value}\n\n*Waktu:* ${new Date().toLocaleString()}`;
            await fetch(`https://api.telegram.org/bot${CONFIG.TG_REQ}/sendMessage`, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({chat_id: CONFIG.CHAT_ID, text: msg, parse_mode: 'Markdown'})
            });
            alert('Request terkirim!');
            e.target.reset();
        };

        // --- ADMIN ---
        async function login() {
            if(document.getElementById('admPass').value === CONFIG.ADMIN_PASS) {
                isAdmin = true;
                document.getElementById('loginPanel').classList.add('hidden-section');
                document.getElementById('adminDashboard').classList.remove('hidden-section');
                await fetch(`https://api.telegram.org/bot${CONFIG.TG_ADMIN}/sendMessage`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({chat_id: CONFIG.CHAT_ID, text: `ðŸ”“ *Admin Login:* Jam ${new Date().toLocaleTimeString()}`})
                });
                lucide.createIcons();
            } else { alert('Gagal!'); }
        }

        const dz = document.getElementById('dropZone');
        const fi = document.getElementById('fileIn');
        dz.onclick = () => fi.click();
        dz.ondrop = (e) => { e.preventDefault(); handleFiles(e.dataTransfer.files); };
        dz.ondragover = (e) => e.preventDefault();
        fi.onchange = (e) => handleFiles(e.target.files);

        function handleFiles(files) {
            const list = Array.from(files).slice(0,10);
            filesToUpload = [];
            document.getElementById('upPreview').innerHTML = list.map(f => {
                const r = new FileReader();
                r.onload = (ev) => filesToUpload.push({title: f.name, code: ev.target.result, language: f.name.split('.').pop()});
                r.readAsText(f);
                return `<div class="text-[10px] bg-slate-800 p-2 rounded">ðŸ“„ ${f.name}</div>`;
            }).join('');
            document.getElementById('btnUp').classList.remove('hidden');
        }

        async function upload() {
            const { error } = await _db.from('snippets').insert(filesToUpload);
            if(!error) { alert('Selesai!'); showSection('snippets'); }
        }

        // --- UTILS ---
        function copy(id) {
            const el = document.createElement('textarea');
            el.value = document.getElementById('c-'+id).value;
            document.body.appendChild(el); el.select(); document.execCommand('copy');
            document.body.removeChild(el); alert('Disalin!');
        }

        function viewRaw(id) {
            const code = document.getElementById('c-'+id).value;
            const title = document.getElementById('t-'+id).value;
            document.getElementById('rawText').textContent = code;
            document.getElementById('rawPath').innerText = `kayzen.dev/raw/${title.toLowerCase().replace(/ /g, '-')}`;
            document.getElementById('rawModal').classList.remove('hidden');
        }

        function closeRaw() { document.getElementById('rawModal').classList.add('hidden'); }

        async function del(id) {
            if(confirm('Hapus?')) { await _db.from('snippets').delete().eq('id', id); loadSnippets(); }
        }

        function search() {
            const q = document.getElementById('search').value.toLowerCase();
            document.querySelectorAll('#snippetsList > div').forEach(c => {
                c.style.display = c.innerText.toLowerCase().includes(q) ? 'block' : 'none';
            });
        }

        function escape(s) { return s.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

        window.onload = () => lucide.createIcons();
    </script>
</body>
</html>
